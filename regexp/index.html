<!doctype html>
<html lang=en>
<head>
	<title>regexp</title>
	<meta charset=utf-8>
	<meta name=viewport content="width=device-width, initial-scale=1.0">
	<meta name=description content="word filter">
	<link rel="stylesheet" href="../_src/main.css">
	<script type=module src="../_src/data-lang.js"></script>
</head>

<body>

<div style="display: flex; justify-content: space-between;">
	<h2><a data-lang="el=>el.href=`/#${el.lang}`"><i><svg><use href="/icon.svg#dice"></use></svg></i></a> schem.ist</h2>
	<data-lang>en fr de es</data-lang>
</div>
<hr>

<!-- <details>
	<summary data-lang>examples // exemples // Beispiele // ejemplos</summary>
	<li data-lang>
		<a lang=en href="./#en/1sqfEBX,BWl1Cs2xNv;j0kyVf~+tT?zJ,RFoq@j6OntNx_:MP/NMIpSj9s~2_F$kN&?i1hp2jjHE:/f)rbhwzJ/f+3wk0tm5Z=hrG">
		variable rate and duration investment
		</a>
		<a lang=fr href="./#fr/1sqfEBX,BWl1Cs2xNv;j0kyVf~+tT?zJ,RFoq@j6OntNx_:MP/NMIpSj9s~2_F$kN&?i1hp2jjHE:/f)rbhwzJ/f+3wk0tm5Z=hrG">
		investissement à durée et rendement variable
	</a></li>
</details>
 -->
<h3 data-lang>regex filter // filtre regex // Regex Filter // filtro regexp</h3>
<pre><textarea id=regexp rows=1 autofocus>^ex.{6}$</textarea></pre>

<h3><span data-lang>results // résultats // Ergebnisse // resultados</span> (<span id=count>0</span>)</h3>
<pre id=result style=column-count:auto;column-width:30ch;></pre>

<script type=module>
import hashData from '../_src/hash-data.js'

const $ = ids => document.getElementById(ids[0]),
			dics = {}

async function fetchList(lang) {
	const url = `https://raw.githubusercontent.com/lorenbrichter/Words/master/Words/${lang}.txt`
	return dics[lang] || (dics[lang] = (await (await fetch(url)).text()).trim().split(/[ ;,]*[\r\n]\s*/))
}

let last = ''

function showList(list) {
	$`result`.textContent=list.join('\n')
	$`count`.textContent=list.length
}

const dohash = hashData(data => {
	const lang = document.documentElement.lang,
				code = data || $`regexp`.value
	showList([])
	last = lang + code
	fetchList(lang).then(dic => {
		if (lang + code === last) { //if not, another callback will follow
			//TODO RAF
			showList(dic.filter( w => new RegExp(code, 'iu').test(w)))
		}
	}).catch(e=>console.warn(e.message))
})

$`regexp`.oninput = evt => dohash(evt.currentTarget.value)

</script>
</body>
